<!DOCTYPE HTML>
<html lang="en">
<head>
    <title>Timeline | Basic demo</title>

    <style type="text/css">
        body, html {
            font-family: sans-serif;
        }
    </style>
    <script type="text/javascript" src="//unpkg.com/papaparse@latest/papaparse.min.js"></script>
    <script src="//unpkg.com/vis-timeline@latest/standalone/umd/vis-timeline-graph2d.min.js"></script>
    <link href="//unpkg.com/vis-timeline@latest/styles/vis-timeline-graph2d.min.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<input type="file" id="file-input"/>
<div id="visualization"></div>
<script type="text/javascript">
    function readSingleFile(e) {
        let file = e.target.files[0];
        if (!file) {
            return;
        }
        let reader = new FileReader();
        reader.onload = function () {
            let contents = reader.result;
            displayContents(contents);
        };
        reader.readAsText(file);
    }

    function displayContents(contents) {

        // DOM element where the Timeline will be attached
        let container = document.getElementById('visualization');

        let parsedData = Papa.parse(contents);
        // Create a DataSet (allows two way data-binding)
        let timelineItems = [];
        let index = 1;
        parsedData.data.slice(1, 500).forEach(row => {
            if (row.length === 13) {
                timelineItems.push({id: index, content: row[2], start: row[0]});
                index++;
            }
        });

        let items = new vis.DataSet(timelineItems);

        // Configuration for the Timeline
        let options = {start: '01-01-1905', end:'01-01-1945'};
        // Create a Timeline
        new vis.Timeline(container, items, options);
    }

    document.getElementById('file-input')
        .addEventListener('change', readSingleFile, false);


</script>

</body>
</html>